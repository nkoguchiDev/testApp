---
name: Users stage
description: Users

stages:
  - id: generate_admin_user
    name: generate admin user
    # skip: False

    request:
      url: http://{host}/api/{version}/users
      method: POST
      params:
        admin: True
      headers:
        content-type: application/json
      json:
        email: "{email:s}"
        password: "{password:s}"
    response:
      status_code: 201
      json:
        email: "{email:s}"
        is_active: True
        is_superuser: True
        full_name: null

  - id: create_session
    name: create session

    request:
      url: http://{host}/api/{version}/session
      method: POST
      headers:
        content-type: application/json
      json:
        email: "{email:s}"
        password: "{password:s}"
    response:
      status_code: 201
      cookies:
        - ""

  - id: remove_admin_user
    name: remove admin user

    request:
      url: http://{host}/api/{version}/users
      method: DELETE
    response:
      status_code: 204
